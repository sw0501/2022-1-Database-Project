/* 이름: demo_madang.sql */
/* 설명 */
 
/* root 계정으로 접속, madang 데이터베이스 생성, madang 계정 생성 */
/* MySQL Workbench에서 초기화면에서 +를 눌러 root connection을 만들어 접속한다. */
DROP DATABASE IF EXISTS  madang;
DROP USER IF EXISTS  madang@localhost;
create user madang@localhost identified WITH mysql_native_password  by 'madang';
create database madang;
grant all privileges on madang.* to madang@localhost with grant option;
commit;

/* madang DB 자료 생성 */
/* 이후 실습은 MySQL Workbench에서 초기화면에서 +를 눌러 madang connection을 만들어 접속하여 사용한다. */
  
USE madang;

/*상영회차는 sql count로 계산한 다음에 넣어줘야 할듯*/


CREATE TABLE Movie (
  movieid   INTEGER PRIMARY KEY,
  moviename   VARCHAR(40),
  runtime   FLOAT,
  grade      VARCHAR(40),
  director   VARCHAR(40),
  actor      VARCHAR(40),
  genre      VARCHAR(40),
  intro      VARCHAR(40),
  opendate   VARCHAR(40)
);

CREATE TABLE Screen (
  screenid   INTEGER PRIMARY KEY,
  seatnum   INTEGER,
  isscreenuse   BOOL
);

CREATE TABLE _Member(
  memberid   INTEGER PRIMARY KEY,
  membername   VARCHAR(40),
  phonenum  VARCHAR(40) UNIQUE,
  email   VARCHAR(40) UNIQUE
);

CREATE TABLE _Schedule(
  scheduleid   INTEGER PRIMARY KEY,
  movieid   INTEGER,
  screenid  INTEGER,
  sopendate   VARCHAR(40),
  sopenday   VARCHAR(40),
  screencount INTEGER,
  sopentime   VARCHAR(40),
  FOREIGN KEY (movieid) REFERENCES Movie(movieid),
  FOREIGN KEY (screenid) REFERENCES Screen(screenid)
);

CREATE TABLE Seat(
  seatid   INTEGER PRIMARY KEY,
  screenid   INTEGER,
  isseat  BOOL,
  FOREIGN KEY (screenid) REFERENCES Screen(screenid)
);

CREATE TABLE Reservation(
  reservationid   INTEGER PRIMARY KEY,
  paymentmethod   VARCHAR(40),
  paymentstate  BOOL,
  paymentprice   INTEGER,
  memberid   INTEGER,
  paymentdate VARCHAR(40),
  FOREIGN KEY (memberid) REFERENCES _Member(memberid)
);

CREATE TABLE Ticket(
  ticketid   INTEGER PRIMARY KEY,
  scheduleid   INTEGER,
  screenid  INTEGER,
  seatid   INTEGER UNIQUE,
  reservationid   INTEGER UNIQUE,
  isticketing BOOL,
  standardprice   INTEGER,
  saleprice INTEGER,
  FOREIGN KEY (scheduleid) REFERENCES _Schedule(scheduleid),
  FOREIGN KEY (screenid) REFERENCES Screen(screenid),
  FOREIGN KEY (seatid) REFERENCES Seat(seatid),
  FOREIGN KEY (reservationid) REFERENCES Reservation(reservationid)
);

INSERT INTO _Member VALUES(0601,"박상욱","010-5187-5312","dkxkqkrtkddn@naver.com");
INSERT INTO _Member VALUES(0602,"손재호","010-1111-2222","sonjaeho@naver.com");
INSERT INTO _Member VALUES(0603,"동기창","010-1111-3333","dongi@naver.com");
INSERT INTO _Member VALUES(0604,"김도형","010-0112-5555","dohyeong@naver.com");
INSERT INTO _Member VALUES(0605,"이승언","010-2232-1112","aaa@naver.com");
INSERT INTO _Member VALUES(0606,"이규리","010-1232-5312","bbb@naver.com");
INSERT INTO _Member VALUES(0607,"임영빈","010-5551-8086","imyoung@naver.com");
INSERT INTO _Member VALUES(0608,"박규태","010-1235-2825","gyutae@naver.com");
INSERT INTO _Member VALUES(0609,"주이식","010-2959-1293","hello2sic@naver.com");
INSERT INTO _Member VALUES(0610,"강은우","010-1232-9693","kangenuo@gmail.com");

INSERT INTO Screen VALUES(0301,2,TRUE);
INSERT INTO Screen VALUES(0302,2,TRUE);
INSERT INTO Screen VALUES(0303,2,TRUE);
INSERT INTO Screen VALUES(0304,2,TRUE);
INSERT INTO Screen VALUES(0305,2,TRUE);
INSERT INTO Screen VALUES(0306,2,TRUE);
INSERT INTO Screen VALUES(0307,2,TRUE);
INSERT INTO Screen VALUES(0308,2,TRUE);
INSERT INTO Screen VALUES(0309,2,TRUE);
INSERT INTO Screen VALUES(0310,2,TRUE);

INSERT INTO Reservation VALUES(0701,"온라인결제",TRUE,10000,0601,20210101);
INSERT INTO Reservation VALUES(0702,"온라인결제",TRUE,10000,0602,20210202);
INSERT INTO Reservation VALUES(0703,"온라인결제",TRUE,10000,0603,20210303);
INSERT INTO Reservation VALUES(0704,"온라인결제",TRUE,10000,0604,20210404);
INSERT INTO Reservation VALUES(0705,"온라인결제",TRUE,10000,0605,20210305);
INSERT INTO Reservation VALUES(0706,"온라인결제",TRUE,15000,0606,20210206);
INSERT INTO Reservation VALUES(0707,"온라인결제",TRUE,15000,0607,20210107);
INSERT INTO Reservation VALUES(0708,"온라인결제",TRUE,15000,0608,20210308);
INSERT INTO Reservation VALUES(0709,"온라인결제",TRUE,15000,0609,20210209);
INSERT INTO Reservation VALUES(0710,"온라인결제",TRUE,15000,0610,20210410);

INSERT INTO Movie VALUES(0101,"해운대",2,"19","강동민","하지원","재난","쓰나미를 피하라",20210130);
INSERT INTO Movie VALUES(0102,"인셉션",3,"15","이동엽","레오나르도 디카프리오","추리","꿈속의 꿈",20210209);
INSERT INTO Movie VALUES(0103,"범죄도시",2,"19","이경은","마동석","액션","마동석의 액션쾌감",20210307);
INSERT INTO Movie VALUES(0104,"범죄도시2",2,"15","김하늬","마동석","액션","액션쾌감의 마동석",20210430);
INSERT INTO Movie VALUES(0105,"마스터",2,"15","엄준식","현빈","추리","속고 속이는 마스터",20210509);
INSERT INTO Movie VALUES(0106,"공공의적",2,"15","장지환","설경구","액션","모두가 모두의 적이다",20210613);
INSERT INTO Movie VALUES(0107,"2012",3,"12","김찬호","우디 해럴슨","재난","몰려오는 재난을 피해라",20210731);
INSERT INTO Movie VALUES(0108,"쥬라기월드",3,"12","박보영","크리스 프랫","액션","공룡이 되살아났다",20210814);
INSERT INTO Movie VALUES(0109,"컨져링",2,"19","이지은","류국봉","공포","상상 그 이상으로 무서움",20210927);
INSERT INTO Movie VALUES(0110,"곡성",2,"15","임수빈","윤찬영","공포","뭣이 중한디!",20211019);


INSERT INTO _Schedule VALUES(0201,0101,0301,20210130,"토요일",1,1500);   
INSERT INTO _Schedule VALUES(0202,0102,0302,20210209,"월요일",1,1500);
INSERT INTO _Schedule VALUES(0203,0103,0303,20210307,"화요일",1,1500);
INSERT INTO _Schedule VALUES(0204,0104,0304,20210430,"수요일",1,1500);
INSERT INTO _Schedule VALUES(0205,0105,0305,20210509,"목요일",1,1500);
INSERT INTO _Schedule VALUES(0206,0106,0306,20210613,"금요일",1,1500);
INSERT INTO _Schedule VALUES(0207,0107,0307,20210731,"토요일",1,1500);
INSERT INTO _Schedule VALUES(0208,0108,0308,20210814,"일요일",1,1500);
INSERT INTO _Schedule VALUES(0209,0109,0309,20210927,"월요일",1,1500);
INSERT INTO _Schedule VALUES(0210,0110,0310,20211019,"화요일",1,1500);
INSERT INTO _Schedule VALUES(0211,0101,0302,20210129,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0212,0101,0303,20210130,"토요일",3,1500);
INSERT INTO _Schedule VALUES(0213,0102,0301,20210205,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0214,0104,0304,20210406,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0215,0105,0301,20210510,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0216,0106,0301,20210606,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0217,0107,0301,20210717,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0218,0107,0301,20210717,"토요일",3,1500);
INSERT INTO _Schedule VALUES(0219,0107,0301,20210716,"토요일",4,1500);
INSERT INTO _Schedule VALUES(0220,0108,0301,20210820,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0221,0109,0301,20210921,"토요일",2,1500);
INSERT INTO _Schedule VALUES(0222,0110,0301,20211011,"토요일",2,1500);

INSERT INTO Seat VALUES(0501,0301,TRUE);
INSERT INTO Seat VALUES(0502,0302,TRUE);
INSERT INTO Seat VALUES(0503,0303,TRUE);
INSERT INTO Seat VALUES(0504,0304,TRUE);
INSERT INTO Seat VALUES(0505,0305,TRUE);
INSERT INTO Seat VALUES(0506,0306,TRUE);
INSERT INTO Seat VALUES(0507,0307,TRUE);
INSERT INTO Seat VALUES(0508,0308,TRUE);
INSERT INTO Seat VALUES(0509,0309,TRUE);
INSERT INTO Seat VALUES(0510,0310,TRUE);
INSERT INTO Seat VALUES(0511,0301,FALSE);
INSERT INTO Seat VALUES(0512,0302,FALSE);
INSERT INTO Seat VALUES(0513,0303,FALSE);
INSERT INTO Seat VALUES(0514,0304,FALSE);
INSERT INTO Seat VALUES(0515,0305,FALSE);
INSERT INTO Seat VALUES(0516,0306,FALSE);
INSERT INTO Seat VALUES(0517,0307,FALSE);
INSERT INTO Seat VALUES(0518,0308,FALSE);
INSERT INTO Seat VALUES(0519,0309,FALSE);
INSERT INTO Seat VALUES(0520,0310,FALSE);

INSERT INTO Ticket VALUES(0401,0201,0301,0501,0701,TRUE,15000,10000);
INSERT INTO Ticket VALUES(0402,0202,0302,0502,0702,TRUE,15000,10000);
INSERT INTO Ticket VALUES(0403,0203,0303,0503,0703,TRUE,15000,10000);
INSERT INTO Ticket VALUES(0404,0204,0304,0504,0704,TRUE,15000,10000);
INSERT INTO Ticket VALUES(0405,0205,0305,0505,0705,TRUE,15000,10000);
INSERT INTO Ticket VALUES(0406,0206,0306,0506,0706,TRUE,15000,15000);
INSERT INTO Ticket VALUES(0407,0207,0307,0507,0707,TRUE,15000,15000);
INSERT INTO Ticket VALUES(0408,0208,0308,0508,0708,TRUE,15000,15000);
INSERT INTO Ticket VALUES(0409,0209,0309,0509,0709,TRUE,15000,15000);
INSERT INTO Ticket VALUES(0410,0210,0310,0510,0710,TRUE,15000,15000);
INSERT INTO Ticket VALUES(0411,0201,0301,0511,NULL,FALSE,15000,20000);
INSERT INTO Ticket VALUES(0412,0202,0302,0512,NULL,FALSE,15000,20000);
INSERT INTO Ticket VALUES(0413,0203,0303,0513,NULL,FALSE,15000,20000);
INSERT INTO Ticket VALUES(0414,0204,0304,0514,NULL,FALSE,15000,20000);
INSERT INTO Ticket VALUES(0415,0205,0305,0515,NULL,FALSE,15000,20000);
INSERT INTO Ticket VALUES(0416,0206,0306,0516,NULL,FALSE,15000,25000);
INSERT INTO Ticket VALUES(0417,0207,0307,0517,NULL,FALSE,15000,25000);
INSERT INTO Ticket VALUES(0418,0208,0308,0518,NULL,FALSE,15000,25000);
INSERT INTO Ticket VALUES(0419,0209,0309,0519,NULL,FALSE,15000,25000);
INSERT INTO Ticket VALUES(0420,0210,0310,0520,NULL,FALSE,15000,25000);